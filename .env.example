# =============================================================================
# {{PROJECT_NAME}} - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values.
# See SETUP.md for detailed instructions on setting up external services.
# =============================================================================
#
# QUICK START:
# 1. cp .env.example .env
# 2. Fill in required values (marked with ⚠️)
# 3. Optional values have sensible defaults for local development
#
# =============================================================================

# -----------------------------------------------------------------------------
# DATABASE ⚠️ Required
# -----------------------------------------------------------------------------
# PostgreSQL connection string
#
# Local Development (with Docker):
#   postgresql://postgres:postgres@localhost:5432/{{PROJECT_NAME}}_dev
#
# Cloud Providers:
#   Neon:     https://console.neon.tech → Project → Connection Details
#   Supabase: https://supabase.com/dashboard → Project → Settings → Database
#   Railway:  https://railway.app → Project → PostgreSQL → Connect
#   PlanetScale: https://planetscale.com (MySQL, not recommended)
#
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/{{PROJECT_NAME}}_dev

# -----------------------------------------------------------------------------
# REDIS ⚠️ Required
# -----------------------------------------------------------------------------
# Redis for BullMQ jobs, rate limiting, and caching
#
# Local Development (with Docker):
#   redis://localhost:6379
#
# Cloud Providers:
#   Upstash:     https://console.upstash.com → Database → Details
#   Redis Cloud: https://app.redislabs.com → Databases → Connect
#   Railway:     https://railway.app → Project → Redis → Connect
#
REDIS_URL=redis://localhost:6379

# -----------------------------------------------------------------------------
# NODE ENVIRONMENT
# -----------------------------------------------------------------------------
# development | production | test
NODE_ENV=development

# -----------------------------------------------------------------------------
# API CONFIGURATION
# -----------------------------------------------------------------------------
API_PORT=4000
# CORS origin - must match your frontend URL
CORS_ORIGIN=http://localhost:3000

# -----------------------------------------------------------------------------
# WEB CONFIGURATION
# -----------------------------------------------------------------------------
WEB_PORT=3000
# API URL for frontend requests (include /api/v1 path)
NEXT_PUBLIC_API_URL=http://localhost:4000/api/v1
# Frontend URL for email links, redirects, and auth callbacks
APP_URL=http://localhost:3000
NEXT_PUBLIC_APP_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# AUTHENTICATION (better-auth) ⚠️ Required
# -----------------------------------------------------------------------------
# Secret key for auth tokens (min 32 chars)
# Generate with: openssl rand -base64 32
# ⚠️ MUST be changed in production!
BETTER_AUTH_SECRET=your-secret-key-change-in-production-min-32-chars
BETTER_AUTH_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# EMAIL (Resend) ⚠️ Required for production
# -----------------------------------------------------------------------------
# Get API key: https://resend.com/api-keys
# For development, emails are logged to console if not configured
RESEND_API_KEY=re_your_resend_api_key
# Must be from a verified domain: https://resend.com/domains
# Format: "Display Name <email@yourdomain.com>"
EMAIL_FROM={{PROJECT_DISPLAY_NAME}} <noreply@yourdomain.com>

# =============================================================================
# BILLING & PAYMENTS (Stripe)
# =============================================================================
# Setup Guide: See SETUP.md → External Services Setup → Stripe
# Dashboard: https://dashboard.stripe.com
#
# For local development with webhooks:
#   1. Install Stripe CLI: https://stripe.com/docs/stripe-cli
#   2. Run: stripe listen --forward-to localhost:4000/webhooks/stripe
#   3. Copy the webhook signing secret (whsec_...)
# -----------------------------------------------------------------------------

# API Keys ⚠️ Required for billing features
# Dashboard → Developers → API keys
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key

# Webhook Secret ⚠️ Required for subscription sync
# Dashboard → Webhooks → Endpoint → Signing secret
# Local: Use the secret from `stripe listen` command
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Price IDs ⚠️ Required - Create products in Stripe Dashboard
# Dashboard → Products → Create Product → Add Price → Copy price_... ID
# Backend price IDs (used for checkout session creation)
STRIPE_PRICE_ID_STARTER=price_your_starter_plan_id
STRIPE_PRICE_ID_PRO=price_your_pro_plan_id
STRIPE_PRICE_ID_ENTERPRISE=price_your_enterprise_plan_id

# Frontend price IDs (exposed to browser for plan selection UI)
NEXT_PUBLIC_STRIPE_PRICE_ID_BASIC=price_your_basic_plan_id
NEXT_PUBLIC_STRIPE_PRICE_ID_PRO=price_your_pro_plan_id
NEXT_PUBLIC_STRIPE_PRICE_ID_ENTERPRISE=price_your_enterprise_plan_id

# Price ID to Plan mapping (for webhook processing)
# Format: "price_id:plan_name,price_id:plan_name"
STRIPE_PRICE_TO_PLAN_MAP="price_your_starter_plan_id:starter,price_your_pro_plan_id:pro,price_your_enterprise_plan_id:enterprise"

# =============================================================================
# FILE STORAGE (S3-Compatible)
# =============================================================================
# This project supports any S3-compatible storage:
#   - Cloudflare R2 (recommended, generous free tier)
#   - AWS S3
#   - MinIO (self-hosted)
#   - DigitalOcean Spaces
#   - Backblaze B2
#
# Setup Guide: See SETUP.md → External Services Setup → Cloudflare R2
# -----------------------------------------------------------------------------

# Cloudflare R2 Configuration
# R2 Dashboard: https://dash.cloudflare.com → R2

# Account ID: Found in R2 dashboard URL or sidebar
R2_ACCOUNT_ID=your_r2_account_id

# API Token: R2 → Manage R2 API Tokens → Create API Token
# Required permissions: Object Read & Write
R2_ACCESS_KEY_ID=your_r2_access_key_id
R2_SECRET_ACCESS_KEY=your_r2_secret_access_key

# Bucket name: R2 → Create bucket
R2_BUCKET_NAME={{PROJECT_NAME}}-uploads

# Public URL (optional): Enable public access or use custom domain
# R2 → Bucket → Settings → Public Access or Custom Domains
R2_PUBLIC_URL=

# =============================================================================
# RATE LIMITING
# =============================================================================
# Plan-based API rate limiting using Redis
# See apps/api/src/rate-limiting/ for configuration
# -----------------------------------------------------------------------------

# Enable/disable rate limiting (default: true)
RATE_LIMIT_ENABLED=true

# Fail-open behavior when Redis is unavailable
# true = allow requests (more permissive, better UX)
# false = reject requests (more secure)
RATE_LIMIT_FAIL_OPEN=true

# =============================================================================
# BACKGROUND JOBS (Worker)
# =============================================================================
# BullMQ worker configuration
# See apps/worker/ for job handlers
# -----------------------------------------------------------------------------

# Number of concurrent jobs to process (default: 5)
# Increase for high-throughput, decrease for resource-constrained environments
WORKER_CONCURRENCY=5

# =============================================================================
# OBSERVABILITY (OpenTelemetry)
# =============================================================================
# Distributed tracing, structured logging, and metrics
# See docker/ folder for local Grafana/Tempo/Loki/Prometheus stack
#
# Cloud Providers:
#   Grafana Cloud: https://grafana.com/products/cloud/
#   Honeycomb:     https://www.honeycomb.io/
#   Datadog:       https://www.datadoghq.com/
# -----------------------------------------------------------------------------

# Enable OpenTelemetry (default: false for development)
OTEL_ENABLED=false

# Exporter type: console (dev) or otlp (production)
OTEL_EXPORTER_TYPE=console

# OTLP endpoint for trace export
# Local Tempo: http://localhost:4318
# Grafana Cloud: https://otlp-gateway-prod-us-central-0.grafana.net/otlp
# Honeycomb: https://api.honeycomb.io
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318

# Service names for traces (auto-detected if not set)
OTEL_SERVICE_NAME_API={{PROJECT_NAME}}-api
OTEL_SERVICE_NAME_WORKER={{PROJECT_NAME}}-worker

# Structured logging level: trace, debug, info, warn, error, fatal
LOG_LEVEL=info
