# =============================================================================
# ForgeStack - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values
# =============================================================================

# -----------------------------------------------------------------------------
# DATABASE
# -----------------------------------------------------------------------------
# PostgreSQL connection string
# Local: postgresql://postgres:postgres@localhost:5432/forgestack_dev
# Neon: https://console.neon.tech → Project → Connection Details
# Supabase: https://app.supabase.com → Project Settings → Database
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/forgestack_dev

# -----------------------------------------------------------------------------
# REDIS
# -----------------------------------------------------------------------------
# Redis for BullMQ jobs, rate limiting, and caching
# Local: redis://localhost:6379
# Upstash: https://console.upstash.com → Database → Details
# Redis Cloud: https://app.redislabs.com → Databases → Connect
REDIS_URL=redis://localhost:6379

# -----------------------------------------------------------------------------
# NODE ENVIRONMENT
# -----------------------------------------------------------------------------
NODE_ENV=development

# -----------------------------------------------------------------------------
# API CONFIGURATION
# -----------------------------------------------------------------------------
API_PORT=4000
CORS_ORIGIN=http://localhost:3000

# -----------------------------------------------------------------------------
# WEB CONFIGURATION
# -----------------------------------------------------------------------------
WEB_PORT=3000
NEXT_PUBLIC_API_URL=http://localhost:4000/api/v1
# Frontend URL for email links, redirects, and auth callbacks
APP_URL=http://localhost:3000
NEXT_PUBLIC_APP_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# AUTHENTICATION (better-auth)
# -----------------------------------------------------------------------------
# Secret key for auth tokens (min 32 chars)
# Generate: openssl rand -base64 32
BETTER_AUTH_SECRET=your-secret-key-change-in-production
BETTER_AUTH_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# EMAIL (Resend)
# -----------------------------------------------------------------------------
# Get API key: https://resend.com/api-keys
RESEND_API_KEY=re_your_resend_api_key
# Must be from verified domain: https://resend.com/domains
EMAIL_FROM=ForgeStack <noreply@forgestack.dev>

# =============================================================================
# V2 FEATURES
# =============================================================================

# -----------------------------------------------------------------------------
# STRIPE BILLING
# -----------------------------------------------------------------------------
# Dashboard: https://dashboard.stripe.com/apikeys
# Secret key (sk_test_... or sk_live_...)
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key

# Publishable key for frontend (pk_test_... or pk_live_...)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key

# Webhook secret: Dashboard → Webhooks → Endpoint → Signing secret
# Local testing: stripe listen --forward-to localhost:4000/webhooks/stripe
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Price IDs: Dashboard → Products → Create Product → Add Price
# Copy the price_... ID for each plan
# Backend uses these for subscription creation
STRIPE_PRICE_ID_STARTER=price_starter_plan_id
STRIPE_PRICE_ID_PRO=price_pro_plan_id
STRIPE_PRICE_ID_ENTERPRISE=price_enterprise_plan_id

# Frontend price IDs (exposed to browser for plan selection UI)
NEXT_PUBLIC_STRIPE_PRICE_ID_BASIC=price_basic_plan_id
NEXT_PUBLIC_STRIPE_PRICE_ID_PRO=price_pro_plan_id
NEXT_PUBLIC_STRIPE_PRICE_ID_ENTERPRISE=price_enterprise_plan_id

# -----------------------------------------------------------------------------
# CLOUDFLARE R2 (S3-Compatible File Storage)
# -----------------------------------------------------------------------------
# R2 Dashboard: https://dash.cloudflare.com → R2

# Account ID: Found in dashboard URL or sidebar
R2_ACCOUNT_ID=your_r2_account_id

# API Token: R2 → Manage R2 API Tokens → Create API Token
# Select "Object Read & Write" permission
R2_ACCESS_KEY_ID=your_r2_access_key_id
R2_SECRET_ACCESS_KEY=your_r2_secret_access_key

# Bucket: R2 → Create bucket
R2_BUCKET_NAME=forgestack-uploads

# Public URL (optional): R2 → Bucket → Settings → Public Access
# Or use Custom Domain: R2 → Bucket → Settings → Custom Domains
R2_PUBLIC_URL=

# -----------------------------------------------------------------------------
# RATE LIMITING
# -----------------------------------------------------------------------------
# Enable rate limiting (default: true)
RATE_LIMIT_ENABLED=true

# Allow requests if Redis is down (default: true)
# true = fail open (allow requests)
# false = fail closed (reject requests)
RATE_LIMIT_FAIL_OPEN=true

# -----------------------------------------------------------------------------
# WORKER CONFIGURATION
# -----------------------------------------------------------------------------
# Worker concurrency (default: 5)
WORKER_CONCURRENCY=5

# Stripe price ID to plan name mapping
# Format: "price_id:plan_name,price_id:plan_name"
# Get price IDs from: https://dashboard.stripe.com/products
# Example: "price_starter123:starter,price_pro456:pro,price_ent789:enterprise"
STRIPE_PRICE_TO_PLAN_MAP="price_starter:starter,price_pro:pro,price_enterprise:enterprise"
